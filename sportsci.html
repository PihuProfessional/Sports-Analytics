<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sports Science Analytics - Math Models</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Oswald:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* --- 1. DARK THEME CORE --- */
        body { background-color: #050505; color: #eeeeee; font-family: 'Montserrat', sans-serif; margin: 0; padding: 0; overflow-x: hidden; }
        h1, h2, h3, h4 { font-family: 'Oswald', sans-serif; text-transform: uppercase; letter-spacing: 1px; }
        .cyan { color: #00cccc; }

        /* --- 2. LAYOUT --- */
        .container { max-width: 1400px; margin: 0 auto; padding: 30px; }
        .page-header { border-bottom: 2px solid #00cccc; padding-bottom: 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; }
        .page-header h1 { font-size: 36px; margin: 0; }
        .page-header p { color: #888; margin-top: 5px; font-size: 14px; }
        .grid-layout { display: grid; grid-template-columns: 350px 1fr; gap: 25px; margin-bottom: 30px; }

        /* --- 3. PANELS --- */
        .panel { background: #111; border: 1px solid #333; padding: 25px; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 25px; }
        .panel h3 { color: #00cccc; margin-top: 0; border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 20px; }

        /* --- 4. MATH FORMULA BOX --- */
        .math-box { background: rgba(0, 204, 204, 0.05); border-left: 3px solid #00cccc; padding: 15px; margin-top: 20px; font-family: 'Courier New', monospace; font-size: 11px; color: #ccc; line-height: 1.6; }
        .math-box strong { color: white; font-family: 'Montserrat', sans-serif; font-size: 12px; }

        /* --- 5. INPUTS & BUTTONS --- */
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; color: #aaa; margin-bottom: 5px; font-size: 12px; font-weight: bold; }
        .form-group input { width: 100%; padding: 12px; background: #222; border: 1px solid #444; color: white; border-radius: 4px; outline: none; transition: 0.3s; box-sizing: border-box; }
        .form-group input:focus { border-color: #00cccc; }
        
        .btn-cyan { background: #00cccc; color: black; border: none; padding: 12px; width: 100%; font-weight: bold; cursor: pointer; text-transform: uppercase; font-family: 'Oswald', sans-serif; transition: 0.3s; margin-top: 10px; }
        .btn-cyan:hover { background: white; box-shadow: 0 0 15px #00cccc; }
        .btn-action { background: transparent; border: 1px solid #444; color: #aaa; padding: 8px 15px; cursor: pointer; font-size: 12px; text-transform: uppercase; }
        .btn-action:hover { border-color: #00cccc; color: #00cccc; }

        /* --- 6. TABLE --- */
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; color: #00cccc; padding: 12px; border-bottom: 2px solid #333; font-size: 12px; text-transform: uppercase; }
        td { padding: 12px; border-bottom: 1px solid #222; font-size: 13px; }
        tr:hover { background: rgba(255, 255, 255, 0.05); }

        /* --- 7. CHARTS & STATS --- */
        .charts-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; }
        .chart-box { background: #151515; padding: 15px; border-radius: 8px; border: 1px solid #333; height: 350px; }
        .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 25px; }
        .stat-card { background: #1a1a1a; padding: 20px; border-left: 4px solid #00cccc; text-align: center; }
        .stat-card h4 { color: #888; font-size: 11px; margin: 0; text-transform: uppercase;}
        .stat-card p { font-size: 26px; font-weight: bold; margin: 5px 0 0 0; color: white; }
    </style>
</head>
<body>

    <div class="container">
        
        <div class="page-header">
            <div>
                <h1>SPORTS SCIENCE <span class="cyan">MATHEMATICS</span></h1>
                <p>Applied Kinetic Energy, Probabilistic Fatigue, & Linear Modeling</p>
            </div>
            <div>
                <button class="btn-action" onclick="window.location.href='index.html'">Back to Home</button>
            </div>
        </div>

        <div class="grid-layout">
            
            <div class="left-col">
                <div class="panel">
                    <h3><i class="fas fa-calculator"></i> Math Variables Input</h3>
                    <div class="form-group">
                        <label>Player Variable (Name)</label>
                        <input type="text" id="pName" placeholder="Enter Name">
                    </div>
                    <div class="form-group">
                        <label>Base Stamina (S₀) [1-100]</label>
                        <input type="number" id="pStamina" placeholder="0-100">
                    </div>
                    <div class="form-group">
                        <label>Force Generation (P) [1-100]</label>
                        <input type="number" id="pPower" placeholder="0-100">
                    </div>
                    <div class="form-group">
                        <label>Training Time (t) [Hours/Wk]</label>
                        <input type="number" id="pHours" placeholder="0-50">
                    </div>
                    <div class="form-group">
                        <label>Velocity (v) [km/h]</label>
                        <input type="number" id="pSpeed" placeholder="100-160">
                    </div>
                    <button class="btn-cyan" onclick="addAthlete()">Compute Matrix</button>
                    
                    <div class="math-box">
                        <strong>1. Kinetic Energy (Joules)</strong>
                        KE = 0.5 * m * v² <br>
                        *(m = 0.163kg ball, v converted to m/s)*<br><br>
                        
                        <strong>2. Probabilistic Fatigue</strong>
                        P(F) = 1 - e^(-t / S₀) <br>
                        *(Exponential probability of burnout)*<br><br>
                        
                        <strong>3. Linear Performance Score</strong>
                        Σ(w_i * x_i) = 0.3(S₀) + 0.25(P) + 0.2(t) + 0.25(v_factor)
                    </div>
                </div>
            </div>

            <div class="right-col">
                
                <div class="stats-row">
                    <div class="stat-card"><h4>System Count (n)</h4><p id="statTotal">0</p></div>
                    <div class="stat-card"><h4>Mean Score (μ)</h4><p id="statAvg">0</p></div>
                    <div class="stat-card"><h4>Max Kinetic Eng.</h4><p id="statMaxKE" style="color:#00ff88;">0 J</p></div>
                    <div class="stat-card"><h4>Avg Fatigue Prob.</h4><p id="statFatigue" style="color:#ff4444;">0%</p></div>
                </div>

                <div class="panel">
                    <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                        <h3><i class="fas fa-table"></i> Computed Data Matrix</h3>
                        <div>
                            <button class="btn-action" onclick="loadSampleData()">Load Sample</button>
                            <button class="btn-action" onclick="clearData()" style="color:#ff4444; border-color:#ff4444;">Clear</button>
                        </div>
                    </div>
                    <div style="overflow-x:auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Variable (x)</th>
                                    <th>Score Σ(wx)</th>
                                    <th>Kinetic E. (J)</th>
                                    <th>Fatigue P(F)</th>
                                    <th>Velocity (v)</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="athleteTableBody">
                                <tr><td colspan="6" style="text-align:center; color:#666; padding:20px;">No mathematical data computed yet.</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <h3 class="cyan" style="margin-bottom:20px;">Mathematical Visualization</h3>
        <div class="charts-grid">
            <div class="chart-box"><canvas id="radarChart"></canvas></div>
            <div class="chart-box"><canvas id="barChart"></canvas></div>
            <div class="chart-box"><canvas id="lineChart"></canvas></div>
            <div class="chart-box"><canvas id="scatterChart"></canvas></div>
        </div>

    </div>

    <script>
        let athletes = [];
        let radarChart, barChart, lineChart, scatterChart;

        window.onload = function() { initCharts(); };

        // --- THE MATHEMATICS ---
        function computeMathModels(stamina, power, hours, speed) {
            // 1. Linear Score
            let speedFactor = Math.max(0, (speed - 100) * 2);
            let score = Math.round((stamina * 0.3) + (power * 0.25) + (hours * 0.2) + (speedFactor * 0.25));

            // 2. Kinetic Energy (KE = 0.5 * m * v^2)
            // Cricket ball mass ~ 0.163 kg. Convert km/h to m/s (speed / 3.6)
            let velocityMS = speed / 3.6;
            let kineticEnergy = 0.5 * 0.163 * Math.pow(velocityMS, 2);
            kineticEnergy = Math.round(kineticEnergy);

            // 3. Probabilistic Fatigue (P(F) = 1 - e^(-t / S0))
            // Uses JS Math.exp for Euler's number
            let fatigueProb = 0;
            if(stamina > 0) {
                fatigueProb = (1 - Math.exp(-hours / stamina)) * 100;
            }
            fatigueProb = fatigueProb.toFixed(1);

            return { score, kineticEnergy, fatigueProb };
        }

        function addAthlete() {
            let name = document.getElementById('pName').value;
            let stamina = parseInt(document.getElementById('pStamina').value) || 0;
            let power = parseInt(document.getElementById('pPower').value) || 0;
            let hours = parseFloat(document.getElementById('pHours').value) || 0;
            let speed = parseInt(document.getElementById('pSpeed').value) || 0;

            if(!name) return alert("Please enter a variable name.");

            let mathResults = computeMathModels(stamina, power, hours, speed);

            athletes.push({ 
                name, stamina, power, hours, speed, 
                score: mathResults.score,
                ke: mathResults.kineticEnergy,
                fatigue: mathResults.fatigueProb
            });
            
            updateUI();
            document.querySelectorAll('input').forEach(i => i.value = '');
        }

        function updateUI() {
            let tbody = document.getElementById('athleteTableBody');
            tbody.innerHTML = "";
            
            let totalScore = 0, maxKE = 0, totalFatigue = 0;

            athletes.forEach((p, index) => {
                totalScore += p.score;
                totalFatigue += parseFloat(p.fatigue);
                if(p.ke > maxKE) maxKE = p.ke;

                tbody.innerHTML += `
                    <tr>
                        <td style="color:white; font-weight:bold;">${p.name}</td>
                        <td style="color:#00cccc; font-weight:bold;">${p.score}</td>
                        <td style="color:#00ff88;">${p.ke} Joules</td>
                        <td style="color:#ff4444;">${p.fatigue}%</td>
                        <td>${p.speed} km/h</td>
                        <td><button class="btn-action" onclick="deletePlayer(${index})">X</button></td>
                    </tr>
                `;
            });

            // Update Math Stats
            document.getElementById('statTotal').innerText = athletes.length;
            document.getElementById('statAvg').innerText = athletes.length ? Math.round(totalScore / athletes.length) : 0;
            document.getElementById('statMaxKE').innerText = maxKE + " J";
            document.getElementById('statFatigue').innerText = athletes.length ? (totalFatigue / athletes.length).toFixed(1) + "%" : "0%";

            updateCharts();
        }

        function deletePlayer(index) { athletes.splice(index, 1); updateUI(); }
        function clearData() { athletes = []; updateUI(); }

        function loadSampleData() {
            let sampleData = [
                { name: "Var(X)", stamina: 95, power: 85, hours: 40, speed: 145 },
                { name: "Var(Y)", stamina: 85, power: 95, hours: 35, speed: 130 },
                { name: "Var(Z)", stamina: 80, power: 60, hours: 45, speed: 155 }
            ];
            
            sampleData.forEach(p => {
                let m = computeMathModels(p.stamina, p.power, p.hours, p.speed);
                athletes.push({ ...p, score: m.score, ke: m.kineticEnergy, fatigue: m.fatigueProb });
            });
            updateUI();
        }

        // --- CHART CONFIGURATION ---
        function initCharts() {
            Chart.defaults.color = '#888';
            Chart.defaults.borderColor = '#333';

            radarChart = new Chart(document.getElementById('radarChart'), {
                type: 'radar',
                data: { labels: ['Stamina (S₀)', 'Power (P)', 'Kinetic Eng. (J)', 'Speed (v)', 'Score Σ(wx)'], datasets: [] },
                options: { maintainAspectRatio: false, scales: { r: { grid: { color: '#333' }, pointLabels: { color: '#00cccc' } } } }
            });

            barChart = new Chart(document.getElementById('barChart'), {
                type: 'bar',
                data: { labels: [], datasets: [{ label: 'Kinetic Energy Output (Joules)', backgroundColor: '#00ff88', data: [] }] },
                options: { maintainAspectRatio: false }
            });

            lineChart = new Chart(document.getElementById('lineChart'), {
                type: 'line',
                data: { labels: [], datasets: [{ label: 'Probability of Fatigue P(F)', borderColor: '#ff4444', backgroundColor: 'rgba(255, 68, 68, 0.2)', fill: true, data: [] }] },
                options: { maintainAspectRatio: false }
            });

            scatterChart = new Chart(document.getElementById('scatterChart'), {
                type: 'scatter',
                data: { datasets: [{ label: 'Score vs Kinetic Energy', backgroundColor: '#00cccc', data: [] }] },
                options: { maintainAspectRatio: false, scales: { x: { title: { display: true, text: 'Linear Score' } }, y: { title: { display: true, text: 'Kinetic Energy (J)' } } } }
            });
        }

        function updateCharts() {
            let names = athletes.map(p => p.name);

            // Update Bar (Kinetic Energy)
            barChart.data.labels = names;
            barChart.data.datasets[0].data = athletes.map(p => p.ke);
            barChart.update();

            // Update Line (Fatigue Probability)
            lineChart.data.labels = names;
            lineChart.data.datasets[0].data = athletes.map(p => p.fatigue);
            lineChart.update();

            // Update Scatter (Score vs KE)
            scatterChart.data.datasets[0].data = athletes.map(p => ({ x: p.score, y: p.ke }));
            scatterChart.update();

            // Update Radar (Showing first player math profile)
            if (athletes.length > 0) {
                let p = athletes[0];
                radarChart.data.datasets = [{
                    label: p.name + " Vector",
                    data: [p.stamina, p.power, p.ke / 2, p.speed / 2, p.score],
                    borderColor: '#00cccc',
                    backgroundColor: 'rgba(0, 204, 204, 0.2)'
                }];
                radarChart.update();
            }
        }
    </script>
</body>
</html>
